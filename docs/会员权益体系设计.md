# AI Universal Generator - ä¼šå‘˜æƒç›Šä½“ç³»è®¾è®¡æ–¹æ¡ˆ

## ä¸€ã€ä¼šå‘˜ç­‰çº§ä½“ç³»è®¾è®¡

### 1.1 ä¼šå‘˜ç­‰çº§åˆ’åˆ†

| ç­‰çº§ | æœˆè´¹ | å¹´è´¹(ä¼˜æƒ ) | å®šä½ |
|------|------|------------|------|
| **Free** | $0 | $0 | ä½“éªŒç”¨æˆ· |
| **Basic** | $9 | $90 (17% off) | ä¸ªäººç”¨æˆ· |
| **Pro** | $29 | $290 (17% off) | ä¸“ä¸šåˆ›ä½œè€… |
| **Enterprise** | $99 | $990 (17% off) | ä¼ä¸š/å›¢é˜Ÿ |

### 1.2 æ ¸å¿ƒæƒç›Šå¯¹æ¯”è¡¨

#### ğŸ¯ AI æ¨¡å‹è®¿é—®æƒé™

| åŠŸèƒ½ | Free | Basic | Pro | Enterprise |
|------|------|-------|-----|------------|
| **æ–‡æœ¬ç”Ÿæˆ** |  |  |  |  |
| GPT-3.5 | âœ… 10æ¬¡/å¤© | âœ… 100æ¬¡/æœˆ | âœ… æ— é™ | âœ… æ— é™ |
| GPT-4 | âŒ | âœ… 20æ¬¡/æœˆ | âœ… 200æ¬¡/æœˆ | âœ… æ— é™ |
| GPT-4o | âŒ | âŒ | âœ… 50æ¬¡/æœˆ | âœ… æ— é™ |
| Claude 3.5 | âŒ | âŒ | âœ… 100æ¬¡/æœˆ | âœ… æ— é™ |
| DeepSeek R1 | âŒ | âœ… 10æ¬¡/æœˆ | âœ… 100æ¬¡/æœˆ | âœ… æ— é™ |
| **å›¾åƒç”Ÿæˆ** |  |  |  |  |
| DALL-E 2 | âŒ | âœ… 10å¼ /æœˆ | âœ… 50å¼ /æœˆ | âœ… æ— é™ |
| DALL-E 3 | âŒ | âŒ | âœ… 20å¼ /æœˆ | âœ… æ— é™ |
| Midjourney | âŒ | âŒ | âœ… 30å¼ /æœˆ | âœ… æ— é™ |
| FLUX | âŒ | âœ… 5å¼ /æœˆ | âœ… 50å¼ /æœˆ | âœ… æ— é™ |
| **è§†é¢‘ç”Ÿæˆ** |  |  |  |  |
| åŸºç¡€è§†é¢‘ | âŒ | âŒ | âœ… 5ä¸ª/æœˆ | âœ… 50ä¸ª/æœˆ |
| é«˜æ¸…è§†é¢‘ | âŒ | âŒ | âŒ | âœ… 20ä¸ª/æœˆ |

#### ğŸ’ ç‹¬ç‰¹åŠŸèƒ½æƒç›Š

| åŠŸèƒ½ | Free | Basic | Pro | Enterprise |
|------|------|-------|-----|------------|
| **ç§¯åˆ†ç³»ç»Ÿ** |  |  |  |  |
| æ³¨å†Œèµ é€ | 10 | 100 | 500 | 2000 |
| æœˆåº¦èµ é€ | 0 | 100 | 500 | 2000 |
| ç§¯åˆ†æœ‰æ•ˆæœŸ | 7å¤© | 30å¤© | 90å¤© | æ°¸ä¹… |
| **ç”Ÿæˆé€Ÿåº¦** |  |  |  |  |
| å“åº”ä¼˜å…ˆçº§ | ä½ | æ ‡å‡† | é«˜ | æœ€é«˜ |
| å¹¶å‘è¯·æ±‚æ•° | 1 | 2 | 5 | 10 |
| é˜Ÿåˆ—ç­‰å¾… | å¯èƒ½ | å°‘é‡ | ä¼˜å…ˆ | æ— éœ€ç­‰å¾… |
| **é«˜çº§åŠŸèƒ½** |  |  |  |  |
| API è®¿é—® | âŒ | âŒ | âœ… é™é€Ÿ | âœ… æ— é™ |
| æ‰¹é‡ç”Ÿæˆ | âŒ | âŒ | âœ… 10ä¸ª | âœ… 100ä¸ª |
| è‡ªå®šä¹‰æ¨¡æ¿ | âŒ | 3ä¸ª | 20ä¸ª | æ— é™ |
| å†å²è®°å½• | 7å¤© | 30å¤© | æ°¸ä¹… | æ°¸ä¹… |
| å¯¼å‡ºåŠŸèƒ½ | âŒ | âœ… | âœ… | âœ… |
| **åä½œåŠŸèƒ½** |  |  |  |  |
| å›¢é˜Ÿå¸­ä½ | - | - | - | 5ä¸ª |
| å…±äº«å·¥ä½œåŒº | âŒ | âŒ | âŒ | âœ… |
| ç®¡ç†é¢æ¿ | âŒ | âŒ | âŒ | âœ… |
| ä½¿ç”¨ç»Ÿè®¡ | âŒ | åŸºç¡€ | è¯¦ç»† | å®Œæ•´åˆ†æ |
| **æ”¯æŒæœåŠ¡** |  |  |  |  |
| ç¤¾åŒºæ”¯æŒ | âœ… | âœ… | âœ… | âœ… |
| Emailæ”¯æŒ | âŒ | âœ… 48h | âœ… 24h | âœ… 2h |
| ä¼˜å…ˆæ”¯æŒ | âŒ | âŒ | âœ… | âœ… |
| ä¸“å±å®¢æœ | âŒ | âŒ | âŒ | âœ… |
| å®šåˆ¶åŸ¹è®­ | âŒ | âŒ | âŒ | âœ… |
| **å…¶ä»–æƒç›Š** |  |  |  |  |
| å»é™¤æ°´å° | âŒ | âœ… | âœ… | âœ… |
| å•†ç”¨æˆæƒ | âŒ | âŒ | âœ… | âœ… |
| ç™½æ ‡åŠŸèƒ½ | âŒ | âŒ | âŒ | âœ… |
| SLAä¿è¯ | âŒ | âŒ | 99% | 99.9% |

## äºŒã€æŠ€æœ¯å®ç°æ–¹æ¡ˆ

### 2.1 æ•°æ®åº“æ”¹é€ 

```sql
-- 1. æ¿€æ´»å·²æœ‰çš„ subscriptions è¡¨
-- (è¡¨ç»“æ„å·²å­˜åœ¨äº src/db/subscriptions-schema.ts)

-- 2. åœ¨ users è¡¨æ·»åŠ è®¢é˜…ç›¸å…³å­—æ®µ
ALTER TABLE users ADD COLUMN subscription_id INTEGER REFERENCES subscriptions(id);
ALTER TABLE users ADD COLUMN subscription_tier VARCHAR(20) DEFAULT 'free';
ALTER TABLE users ADD COLUMN subscription_expires_at TIMESTAMP;

-- 3. åˆ›å»ºåŠŸèƒ½æƒé™æ˜ å°„è¡¨
CREATE TABLE feature_permissions (
  id SERIAL PRIMARY KEY,
  tier VARCHAR(20) NOT NULL, -- free, basic, pro, enterprise
  feature_key VARCHAR(100) NOT NULL, -- åŠŸèƒ½æ ‡è¯†
  allowed BOOLEAN DEFAULT true,
  daily_limit INTEGER, -- æ¯æ—¥é™åˆ¶
  monthly_limit INTEGER, -- æ¯æœˆé™åˆ¶
  config JSONB, -- å…¶ä»–é…ç½®
  UNIQUE(tier, feature_key)
);
```

### 2.2 æƒé™æ£€æŸ¥ä¸­é—´ä»¶

```typescript
// src/middleware/subscription.ts
export async function checkSubscriptionAccess(
  userUuid: string,
  feature: string,
  model?: string
) {
  // 1. è·å–ç”¨æˆ·è®¢é˜…ä¿¡æ¯
  const subscription = await getUserSubscription(userUuid);
  
  // 2. æ£€æŸ¥è®¢é˜…æ˜¯å¦æœ‰æ•ˆ
  if (!subscription || subscription.status !== 'active') {
    return { allowed: false, reason: 'No active subscription' };
  }
  
  // 3. æ£€æŸ¥åŠŸèƒ½æƒé™
  const permission = await getFeaturePermission(subscription.tier, feature);
  
  // 4. æ£€æŸ¥ä½¿ç”¨é™åˆ¶
  if (permission.monthly_limit) {
    const usage = await getMonthlyUsage(userUuid, feature);
    if (usage >= permission.monthly_limit) {
      return { 
        allowed: false, 
        reason: `Monthly limit reached (${usage}/${permission.monthly_limit})` 
      };
    }
  }
  
  // 5. æ£€æŸ¥æ¨¡å‹è®¿é—®æƒé™
  if (model && !permission.allowed_models?.includes(model)) {
    return { 
      allowed: false, 
      reason: `Model ${model} not available in your plan` 
    };
  }
  
  return { allowed: true };
}
```

### 2.3 API è·¯ç”±æ”¹é€ ç¤ºä¾‹

```typescript
// src/app/api/demo/gen-text/route.ts
export async function POST(req: Request) {
  const session = await auth();
  
  // 1. è®¤è¯æ£€æŸ¥
  if (!session?.user?.email) {
    return respErr("Please login first");
  }
  
  // 2. è·å–ç”¨æˆ·ä¿¡æ¯
  const user = await getUserWithSubscription(session.user.email);
  
  // 3. è®¢é˜…æƒé™æ£€æŸ¥
  const accessCheck = await checkSubscriptionAccess(
    user.uuid,
    'text_generation',
    model
  );
  
  if (!accessCheck.allowed) {
    // æ ¹æ®ç”¨æˆ·ç­‰çº§è¿”å›ä¸åŒæç¤º
    if (user.subscription_tier === 'free') {
      return respErr(
        "This feature requires a paid subscription. Upgrade to Basic plan for just $9/month!",
        { upgradeUrl: '/pricing' }
      );
    }
    return respErr(accessCheck.reason);
  }
  
  // 4. æ‰§è¡Œç”Ÿæˆ...
  // 5. è®°å½•ä½¿ç”¨æƒ…å†µ
  await recordUsage(user.uuid, 'text_generation', model);
}
```

## ä¸‰ã€å·®å¼‚åŒ–åŠŸèƒ½å®ç°

### 3.1 é€Ÿåº¦ä¼˜å…ˆçº§é˜Ÿåˆ—

```typescript
// æ ¹æ®ç”¨æˆ·ç­‰çº§åˆ†é…ä¸åŒä¼˜å…ˆçº§
const PRIORITY_LEVELS = {
  free: 1,
  basic: 5,
  pro: 10,
  enterprise: 20
};

// ä½¿ç”¨ Redis å®ç°ä¼˜å…ˆçº§é˜Ÿåˆ—
async function addToQueue(task: GenerationTask) {
  const priority = PRIORITY_LEVELS[task.userTier];
  await redis.zadd('generation_queue', priority, JSON.stringify(task));
}
```

### 3.2 å¹¶å‘é™åˆ¶

```typescript
// ä¸åŒç­‰çº§çš„å¹¶å‘é™åˆ¶
const CONCURRENT_LIMITS = {
  free: 1,
  basic: 2,
  pro: 5,
  enterprise: 10
};

// ä½¿ç”¨ Redis å®ç°å¹¶å‘æ§åˆ¶
async function checkConcurrency(userUuid: string, tier: string) {
  const current = await redis.get(`concurrent:${userUuid}`);
  const limit = CONCURRENT_LIMITS[tier];
  
  if (current >= limit) {
    throw new Error(`Concurrent limit reached (${current}/${limit})`);
  }
  
  await redis.incr(`concurrent:${userUuid}`);
  // è®¾ç½®è¿‡æœŸæ—¶é—´é˜²æ­¢æ­»é”
  await redis.expire(`concurrent:${userUuid}`, 60);
}
```

### 3.3 åŠŸèƒ½å¼€å…³

```typescript
// åŸºäºè®¢é˜…ç­‰çº§çš„åŠŸèƒ½å¼€å…³
const FEATURE_FLAGS = {
  free: {
    watermark: true,
    export: false,
    api_access: false,
    batch_generation: false,
    custom_templates: false,
    advanced_models: false,
  },
  basic: {
    watermark: false,
    export: true,
    api_access: false,
    batch_generation: false,
    custom_templates: true,
    advanced_models: ['gpt-4', 'dall-e-2'],
  },
  pro: {
    watermark: false,
    export: true,
    api_access: true,
    batch_generation: true,
    custom_templates: true,
    advanced_models: ['gpt-4', 'gpt-4o', 'dall-e-3', 'claude-3.5'],
  },
  enterprise: {
    watermark: false,
    export: true,
    api_access: true,
    batch_generation: true,
    custom_templates: true,
    advanced_models: 'all',
    white_label: true,
    custom_domain: true,
  }
};
```

## å››ã€UI/UX å·®å¼‚åŒ–

### 4.1 ä¼šå‘˜æ ‡è¯†

```tsx
// ç”¨æˆ·ç•Œé¢æ˜¾ç¤ºä¼šå‘˜ç­‰çº§
<Badge variant={getUserBadgeVariant(user.subscription_tier)}>
  {user.subscription_tier === 'enterprise' && <Crown className="w-3 h-3 mr-1" />}
  {user.subscription_tier === 'pro' && <Star className="w-3 h-3 mr-1" />}
  {user.subscription_tier === 'basic' && <Zap className="w-3 h-3 mr-1" />}
  {user.subscription_tier.toUpperCase()}
</Badge>
```

### 4.2 åŠŸèƒ½é”å®šæç¤º

```tsx
// å¯¹æœªè§£é”åŠŸèƒ½æ˜¾ç¤ºå‡çº§æç¤º
{!canUseFeature('advanced_models') && (
  <div className="relative">
    <div className="absolute inset-0 bg-black/60 flex items-center justify-center rounded-lg">
      <div className="text-center text-white p-4">
        <Lock className="w-8 h-8 mx-auto mb-2" />
        <p className="font-semibold">Pro Feature</p>
        <p className="text-sm">Upgrade to Pro to unlock</p>
        <Button size="sm" className="mt-2">
          Upgrade Now
        </Button>
      </div>
    </div>
    {/* æ˜¾ç¤ºæ¨¡ç³Šçš„åŠŸèƒ½é¢„è§ˆ */}
    <div className="filter blur-sm pointer-events-none">
      {/* åŠŸèƒ½å†…å®¹ */}
    </div>
  </div>
)}
```

### 4.3 ä½¿ç”¨é‡ä»ªè¡¨æ¿

```tsx
// æ˜¾ç¤ºå½“å‰ä½¿ç”¨é‡å’Œé™åˆ¶
<Card>
  <CardHeader>
    <CardTitle>Usage This Month</CardTitle>
  </CardHeader>
  <CardContent>
    <div className="space-y-4">
      {/* æ–‡æœ¬ç”Ÿæˆä½¿ç”¨é‡ */}
      <div>
        <div className="flex justify-between text-sm mb-1">
          <span>Text Generation</span>
          <span>{usage.text}/{limits.text || 'âˆ'}</span>
        </div>
        <Progress value={(usage.text / limits.text) * 100} />
      </div>
      
      {/* å›¾åƒç”Ÿæˆä½¿ç”¨é‡ */}
      <div>
        <div className="flex justify-between text-sm mb-1">
          <span>Image Generation</span>
          <span>{usage.image}/{limits.image || 'âˆ'}</span>
        </div>
        <Progress value={(usage.image / limits.image) * 100} />
      </div>
      
      {/* è§†é¢‘ç”Ÿæˆä½¿ç”¨é‡ */}
      {user.tier !== 'free' && user.tier !== 'basic' && (
        <div>
          <div className="flex justify-between text-sm mb-1">
            <span>Video Generation</span>
            <span>{usage.video}/{limits.video || 'âˆ'}</span>
          </div>
          <Progress value={(usage.video / limits.video) * 100} />
        </div>
      )}
    </div>
  </CardContent>
</Card>
```

## äº”ã€å®æ–½è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€æ¶æ„ï¼ˆ1å‘¨ï¼‰
1. âœ… æ¿€æ´» subscriptions è¡¨
2. âœ… å®ç°è®¢é˜…æœåŠ¡å±‚
3. âœ… æ·»åŠ æƒé™æ£€æŸ¥ä¸­é—´ä»¶
4. âœ… æ›´æ–°ç”¨æˆ·æ¨¡å‹

### ç¬¬äºŒé˜¶æ®µï¼šåŠŸèƒ½å·®å¼‚åŒ–ï¼ˆ2å‘¨ï¼‰
1. âœ… å®ç°æ¨¡å‹è®¿é—®é™åˆ¶
2. âœ… æ·»åŠ ä½¿ç”¨é‡è¿½è¸ª
3. âœ… å®ç°ä¼˜å…ˆçº§é˜Ÿåˆ—
4. âœ… æ·»åŠ å¹¶å‘æ§åˆ¶

### ç¬¬ä¸‰é˜¶æ®µï¼šUI/UX ä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰
1. âœ… æ›´æ–°å®šä»·é¡µé¢
2. âœ… æ·»åŠ ä¼šå‘˜æ ‡è¯†
3. âœ… å®ç°åŠŸèƒ½é”å®šæç¤º
4. âœ… åˆ›å»ºä½¿ç”¨é‡ä»ªè¡¨æ¿

### ç¬¬å››é˜¶æ®µï¼šé«˜çº§åŠŸèƒ½ï¼ˆ2å‘¨ï¼‰
1. âœ… API è®¿é—®æ§åˆ¶
2. âœ… æ‰¹é‡ç”ŸæˆåŠŸèƒ½
3. âœ… è‡ªå®šä¹‰æ¨¡æ¿ç³»ç»Ÿ
4. âœ… å›¢é˜Ÿåä½œåŠŸèƒ½

## å…­ã€ç›‘æ§ä¸ä¼˜åŒ–

### 6.1 å…³é”®æŒ‡æ ‡
- è½¬åŒ–ç‡ï¼šå…è´¹â†’ä»˜è´¹
- å‡çº§ç‡ï¼šBasicâ†’Proâ†’Enterprise
- ç•™å­˜ç‡ï¼šå„ç­‰çº§ç”¨æˆ·ç•™å­˜
- ä½¿ç”¨ç‡ï¼šåŠŸèƒ½ä½¿ç”¨é¢‘ç‡
- æ»¡æ„åº¦ï¼šNPS è¯„åˆ†

### 6.2 A/B æµ‹è¯•
- ä»·æ ¼æµ‹è¯•
- åŠŸèƒ½ç»„åˆæµ‹è¯•
- é™åˆ¶é˜ˆå€¼æµ‹è¯•
- UI æç¤ºæ–‡æ¡ˆæµ‹è¯•

## ä¸ƒã€ç«å“å¯¹æ¯”ä¼˜åŠ¿

| åŠŸèƒ½ | æˆ‘ä»¬ | OpenAI Plus | Claude Pro | Midjourney |
|------|------|-------------|------------|------------|
| æœˆè´¹ | $9-99 | $20 | $20 | $10-120 |
| å¤šæ¨¡å‹æ”¯æŒ | âœ… å…¨éƒ¨ | âŒ ä»…OpenAI | âŒ ä»…Claude | âŒ ä»…å›¾åƒ |
| API è®¿é—® | âœ… Proèµ· | âŒ | âŒ | âŒ |
| å›¢é˜Ÿåä½œ | âœ… Enterprise | âŒ | âŒ | âŒ |
| ç™½æ ‡å®šåˆ¶ | âœ… Enterprise | âŒ | âŒ | âŒ |
| ä¸­æ–‡ä¼˜åŒ– | âœ… | éƒ¨åˆ† | éƒ¨åˆ† | âŒ |

## å…«ã€è¥é”€ç­–ç•¥

### 8.1 å…è´¹è¯•ç”¨
- æ³¨å†Œé€ 10 ç§¯åˆ†
- 14 å¤© Pro è¯•ç”¨
- é™æ—¶å‡çº§ä¼˜æƒ 

### 8.2 æ¨èå¥–åŠ±
- æ¨èæˆåŠŸé€ç§¯åˆ†
- æ¨èä»˜è´¹ç”¨æˆ·å¾—ä½£é‡‘
- å›¢é˜ŸæŠ˜æ‰£

### 8.3 å­£èŠ‚æ€§ä¿ƒé”€
- é»‘äº”ä¼˜æƒ 
- æ–°å¹´ç‰¹æƒ 
- å­¦ç”ŸæŠ˜æ‰£

## ä¹ã€å•†ä¸šåŒ–è½¬åŒ–ç­–ç•¥

### 9.1 å‡å°‘è´­ä¹°é“¾è·¯

#### ç­–ç•¥ç›®æ ‡
å°†ç”¨æˆ·ä»è®¤çŸ¥åˆ°ä»˜è´¹çš„è·¯å¾„æœ€å°åŒ–ï¼Œå‡å°‘æµå¤±ç‡ã€‚

#### å®æ–½æ–¹æ¡ˆ

```typescript
/**
 * ä¸€é”®å‡çº§ç»„ä»¶
 * é—®é¢˜ï¼šå‡å°‘ç”¨æˆ·å†³ç­–æˆæœ¬å’Œæ“ä½œæ­¥éª¤
 * è§£å†³æ–¹æ¡ˆï¼šåœ¨å…³é”®è§¦ç‚¹åµŒå…¥å¿«é€Ÿå‡çº§å…¥å£
 */
export function QuickUpgradeButton({ feature, currentTier }) {
  return (
    <Button
      onClick={() => {
        // ç›´æ¥è·³è½¬åˆ°æ”¯ä»˜ï¼Œé¢„é€‰æ¨èæ–¹æ¡ˆ
        router.push(`/checkout?plan=pro&period=yearly&ref=${feature}`);
      }}
      className="bg-gradient-to-r from-purple-600 to-pink-600"
    >
      <Zap className="w-4 h-4 mr-1" />
      ç«‹å³è§£é” â€¢ ä»…éœ€ $24/æœˆ
    </Button>
  );
}

// åœ¨åŠŸèƒ½å—é™æ—¶è§¦å‘
export function FeatureLimitModal({ limitType }) {
  const benefits = getUpgradeBenefits(limitType);
  
  return (
    <Modal>
      <div className="text-center p-6">
        <h3>æ‚¨å·²è¾¾åˆ°å…è´¹ç‰ˆé™åˆ¶</h3>
        <p className="text-muted-foreground mt-2">
          å‡çº§åˆ° Pro ç‰ˆæœ¬ï¼Œç«‹å³è·å¾—ï¼š
        </p>
        <ul className="mt-4 space-y-2">
          {benefits.map(benefit => (
            <li key={benefit} className="flex items-center">
              <Check className="w-4 h-4 text-green-500 mr-2" />
              {benefit}
            </li>
          ))}
        </ul>
        <div className="mt-6 space-y-3">
          <Button onClick={handleOneClickUpgrade} size="lg" className="w-full">
            ä¸€é”®å‡çº§ Proï¼ˆçœ17%å¹´è´¹ï¼‰
          </Button>
          <Button variant="outline" onClick={continueFree}>
            ç»§ç»­å…è´¹ç‰ˆ
          </Button>
        </div>
      </div>
    </Modal>
  );
}
```

#### å…³é”®å®æ–½ç‚¹
1. **åµŒå…¥å¼æ”¯ä»˜**ï¼šåœ¨äº§å“å†…ç›´æ¥å®Œæˆæ”¯ä»˜ï¼Œæ— éœ€è·³è½¬
2. **ä¿å­˜æ”¯ä»˜æ–¹å¼**ï¼šè®°ä½ç”¨æˆ·æ”¯ä»˜ä¿¡æ¯ï¼Œå®ç°ä¸€é”®ç»­è´¹
3. **æ™ºèƒ½è§¦å‘æ—¶æœº**ï¼šåœ¨ç”¨æˆ·éœ€æ±‚æœ€å¼ºçƒˆæ—¶å±•ç¤ºå‡çº§é€‰é¡¹
4. **ç®€åŒ–é€‰æ‹©**ï¼šé»˜è®¤æ¨èæœ€ä¼˜æ–¹æ¡ˆï¼Œå‡å°‘é€‰æ‹©å›°éš¾

### 9.2 åšå¥½ä»·æ ¼å·®å¼‚

#### ä»·æ ¼é”šå®šç­–ç•¥

```typescript
// ä»·æ ¼å±•ç¤ºç»„ä»¶ - åˆ©ç”¨é”šå®šæ•ˆåº”
export function PricingDisplay() {
  return (
    <div className="grid grid-cols-3 gap-6">
      {/* Basic - å¯¹æ¯”é”šç‚¹ */}
      <Card>
        <CardHeader>
          <h3>Basic</h3>
          <div className="mt-4">
            <span className="text-3xl font-bold">$9</span>
            <span className="text-muted-foreground">/æœˆ</span>
          </div>
        </CardHeader>
      </Card>
      
      {/* Pro - ä¸»æ¨æ–¹æ¡ˆ */}
      <Card className="border-2 border-primary relative">
        <Badge className="absolute -top-3 left-1/2 -translate-x-1/2">
          æœ€å—æ¬¢è¿
        </Badge>
        <CardHeader>
          <h3>Pro</h3>
          <div className="mt-4">
            <span className="text-3xl font-bold">$29</span>
            <span className="text-muted-foreground">/æœˆ</span>
            <p className="text-sm text-green-600 mt-2">
              ç›¸æ¯” Basic ä»…å¤š $20ï¼ŒåŠŸèƒ½æå‡ 10 å€
            </p>
          </div>
        </CardHeader>
      </Card>
      
      {/* Enterprise - ä»·æ ¼å¤©èŠ±æ¿ */}
      <Card>
        <CardHeader>
          <h3>Enterprise</h3>
          <div className="mt-4">
            <span className="text-3xl font-bold">$99</span>
            <span className="text-muted-foreground">/æœˆ</span>
          </div>
        </CardHeader>
      </Card>
    </div>
  );
}

// ä»·å€¼å¯¹æ¯”è¡¨ - çªå‡ºå·®å¼‚
export function ValueComparison() {
  const metrics = [
    { feature: "API è°ƒç”¨æ¬¡æ•°", basic: "100", pro: "2000", multiplier: "20x" },
    { feature: "æ¨¡å‹é€‰æ‹©", basic: "3ä¸ª", pro: "15ä¸ª", multiplier: "5x" },
    { feature: "ç”Ÿæˆé€Ÿåº¦", basic: "æ ‡å‡†", pro: "ä¼˜å…ˆ", multiplier: "3x" },
    { feature: "å­˜å‚¨ç©ºé—´", basic: "1GB", pro: "50GB", multiplier: "50x" },
  ];
  
  return (
    <Table>
      <TableHeader>
        <TableRow>
          <TableHead>åŠŸèƒ½å¯¹æ¯”</TableHead>
          <TableHead>Basic ($9)</TableHead>
          <TableHead>Pro ($29)</TableHead>
          <TableHead>ä»·å€¼æå‡</TableHead>
        </TableRow>
      </TableHeader>
      <TableBody>
        {metrics.map((item) => (
          <TableRow key={item.feature}>
            <TableCell>{item.feature}</TableCell>
            <TableCell>{item.basic}</TableCell>
            <TableCell className="font-semibold">{item.pro}</TableCell>
            <TableCell>
              <Badge variant="success">{item.multiplier}</Badge>
            </TableCell>
          </TableRow>
        ))}
      </TableBody>
    </Table>
  );
}
```

### 9.3 é»˜è®¤å¹´è´¹

#### å¹´è´¹ä¼˜å…ˆå±•ç¤ºç­–ç•¥

```typescript
/**
 * ä»·æ ¼åˆ‡æ¢ç»„ä»¶
 * ç­–ç•¥ï¼šé»˜è®¤å±•ç¤ºå¹´è´¹ï¼Œå¼ºè°ƒèŠ‚çœé‡‘é¢
 */
export function BillingToggle() {
  const [period, setPeriod] = useState('yearly'); // é»˜è®¤å¹´è´¹
  
  const savings = {
    basic: { monthly: 9, yearly: 7.5, save: 18 },
    pro: { monthly: 29, yearly: 24, save: 60 },
    enterprise: { monthly: 99, yearly: 82.5, save: 198 }
  };
  
  return (
    <div className="flex flex-col items-center space-y-4">
      {/* åˆ‡æ¢æŒ‰é’® - å¹´è´¹é€‰é¡¹æ›´çªå‡º */}
      <div className="inline-flex items-center bg-muted p-1 rounded-lg">
        <button
          onClick={() => setPeriod('monthly')}
          className={cn(
            "px-4 py-2 rounded-md transition",
            period === 'monthly' 
              ? "bg-background shadow-sm" 
              : "text-muted-foreground"
          )}
        >
          æœˆä»˜
        </button>
        <button
          onClick={() => setPeriod('yearly')}
          className={cn(
            "px-4 py-2 rounded-md transition relative",
            period === 'yearly' 
              ? "bg-primary text-primary-foreground shadow-sm" 
              : "text-muted-foreground"
          )}
        >
          å¹´ä»˜
          <Badge className="absolute -top-2 -right-2 text-xs">
            çœ17%
          </Badge>
        </button>
      </div>
      
      {/* èŠ‚çœé‡‘é¢æç¤º */}
      {period === 'yearly' && (
        <p className="text-green-600 font-medium animate-in fade-in">
          ğŸ‰ é€‰æ‹©å¹´ä»˜ï¼Œæ¯å¹´èŠ‚çœ ${savings.pro.save}
        </p>
      )}
    </div>
  );
}

// ç»“è´¦é¡µé¢ - é¢„é€‰å¹´è´¹
export function CheckoutForm({ plan = 'pro' }) {
  const [billingPeriod, setBillingPeriod] = useState('yearly');
  
  const pricing = {
    monthly: { basic: 9, pro: 29, enterprise: 99 },
    yearly: { 
      basic: 90, // æ˜¾ç¤ºæ€»ä»·
      pro: 290,
      enterprise: 990 
    }
  };
  
  return (
    <form>
      {/* è´¦å•å‘¨æœŸé€‰æ‹© - å¹´è´¹æœ‰æŠ˜æ‰£æ ‡ç­¾ */}
      <RadioGroup value={billingPeriod} onValueChange={setBillingPeriod}>
        <div className="space-y-3">
          <label className="flex items-center justify-between p-4 border rounded-lg cursor-pointer hover:bg-accent">
            <div className="flex items-center">
              <RadioGroupItem value="monthly" />
              <div className="ml-3">
                <p className="font-medium">æœˆä»˜</p>
                <p className="text-sm text-muted-foreground">
                  ${pricing.monthly[plan]}/æœˆ
                </p>
              </div>
            </div>
          </label>
          
          <label className="flex items-center justify-between p-4 border-2 border-primary rounded-lg cursor-pointer bg-primary/5">
            <div className="flex items-center">
              <RadioGroupItem value="yearly" />
              <div className="ml-3">
                <p className="font-medium">
                  å¹´ä»˜
                  <Badge className="ml-2" variant="success">æ¨è</Badge>
                </p>
                <p className="text-sm text-muted-foreground">
                  ${(pricing.yearly[plan] / 12).toFixed(2)}/æœˆï¼ˆæ€»è®¡ ${pricing.yearly[plan]}ï¼‰
                </p>
              </div>
            </div>
            <div className="text-right">
              <p className="text-sm font-medium text-green-600">
                èŠ‚çœ17%
              </p>
              <p className="text-xs text-muted-foreground">
                çœ${pricing.monthly[plan] * 12 - pricing.yearly[plan]}
              </p>
            </div>
          </label>
        </div>
      </RadioGroup>
    </form>
  );
}
```

### 9.4 æœ‰æ„è¯†çš„æé†’ç”¨æˆ·ä»˜è´¹

#### æ™ºèƒ½ä»˜è´¹æé†’ç³»ç»Ÿ

```typescript
/**
 * ä»˜è´¹æé†’ç®¡ç†å™¨
 * ç­–ç•¥ï¼šåœ¨åˆé€‚çš„æ—¶æœºå’Œåœºæ™¯æé†’ç”¨æˆ·ä»˜è´¹ä»·å€¼
 */
class PaymentReminderManager {
  // æé†’è§¦å‘è§„åˆ™
  private triggers = {
    // ä½¿ç”¨é‡è§¦å‘
    usageLimit: {
      threshold: 0.8, // ä½¿ç”¨é‡è¾¾åˆ°80%
      message: "æ‚¨å·²ä½¿ç”¨80%çš„å…è´¹é¢åº¦ï¼Œå‡çº§äº«å—æ— é™ä½¿ç”¨",
      action: "æŸ¥çœ‹Proæ–¹æ¡ˆ"
    },
    
    // åŠŸèƒ½è§¦å‘
    featureBlock: {
      message: "æ­¤åŠŸèƒ½ä»…é™Proç”¨æˆ·ï¼Œç«‹å³è§£é”å…¨éƒ¨é«˜çº§åŠŸèƒ½",
      action: "å‡çº§åˆ°Pro"
    },
    
    // æ—¶é—´è§¦å‘
    trialEnding: {
      daysLeft: 3,
      message: "è¯•ç”¨æœŸè¿˜å‰©3å¤©ï¼Œç°åœ¨å‡çº§äº«å—é™æ—¶ä¼˜æƒ ",
      action: "è·å–ä¼˜æƒ "
    },
    
    // æˆå°±è§¦å‘
    milestone: {
      generates: 50,
      message: "æ­å–œï¼æ‚¨å·²ç”Ÿæˆ50ä¸ªä½œå“ï¼Œå‡çº§Proæå‡åˆ›ä½œæ•ˆç‡",
      action: "æå‡æ•ˆç‡"
    }
  };
  
  // å±•ç¤ºä»˜è´¹ä»·å€¼
  showValueProposition(context: string) {
    const benefits = this.getContextualBenefits(context);
    
    return {
      title: "è§£é”æ›´å¤šå¯èƒ½",
      benefits,
      cta: this.getSmartCTA(context),
      urgency: this.createUrgency()
    };
  }
  
  // ä¸Šä¸‹æ–‡ç›¸å…³çš„åˆ©ç›Šç‚¹
  private getContextualBenefits(context: string) {
    const benefitMap = {
      'text_generation': [
        'æ— é™åˆ¶ä½¿ç”¨GPT-4å’ŒClaude',
        'ä¼˜å…ˆå¤„ç†ï¼Œç”Ÿæˆé€Ÿåº¦æå‡3å€',
        'è§£é”é«˜çº§å†™ä½œæ¨¡æ¿'
      ],
      'image_generation': [
        'æ¯æœˆ500å¼ é«˜æ¸…å›¾åƒ',
        'ç‹¬å®¶è®¿é—®DALL-E 3',
        'æ‰¹é‡ç”Ÿæˆå’Œç¼–è¾‘åŠŸèƒ½'
      ],
      'api_limit': [
        'APIè°ƒç”¨é‡æå‡20å€',
        'æ›´é«˜çš„å¹¶å‘è¯·æ±‚æ•°',
        'ä¸“å±æŠ€æœ¯æ”¯æŒ'
      ]
    };
    
    return benefitMap[context] || benefitMap['text_generation'];
  }
  
  // æ™ºèƒ½CTAæ–‡æ¡ˆ
  private getSmartCTA(context: string) {
    const hour = new Date().getHours();
    const isWeekend = [0, 6].includes(new Date().getDay());
    
    if (isWeekend) {
      return "å‘¨æœ«ç‰¹æƒ  â€¢ ç«‹å³å‡çº§";
    }
    
    if (hour >= 9 && hour <= 12) {
      return "æ—©é¸Ÿä¼˜æƒ  â€¢ ç«‹å³å¼€å§‹";
    }
    
    if (hour >= 20) {
      return "é™æ—¶ä¼˜æƒ  â€¢ ä»Šæ—¥æˆªæ­¢";
    }
    
    return "ç«‹å³å‡çº§ â€¢ è§£é”å…¨éƒ¨åŠŸèƒ½";
  }
  
  // åˆ›é€ ç´§è¿«æ„Ÿ
  private createUrgency() {
    const strategies = [
      { type: 'discount', message: 'é™æ—¶7æŠ˜ä¼˜æƒ ' },
      { type: 'bonus', message: 'å‡çº§é€1000ç§¯åˆ†' },
      { type: 'scarcity', message: 'ä»…å‰©æœ€å10ä¸ªä¼˜æƒ åé¢' },
      { type: 'social', message: 'å·²æœ‰5000+ç”¨æˆ·é€‰æ‹©Pro' }
    ];
    
    return strategies[Math.floor(Math.random() * strategies.length)];
  }
}

// UIç»„ä»¶ - æµ®åŠ¨æé†’æ 
export function FloatingUpgradeBar() {
  const [show, setShow] = useState(false);
  const user = useUser();
  
  useEffect(() => {
    // æ™ºèƒ½æ˜¾ç¤ºé€»è¾‘
    if (user.tier === 'free' && user.usageRate > 0.5) {
      setTimeout(() => setShow(true), 5000); // 5ç§’åæ˜¾ç¤º
    }
  }, [user]);
  
  if (!show || user.tier !== 'free') return null;
  
  return (
    <div className="fixed bottom-4 right-4 max-w-sm animate-in slide-in-from-bottom">
      <Card className="border-primary/50 bg-gradient-to-r from-purple-50 to-pink-50">
        <CardContent className="p-4">
          <div className="flex items-start justify-between">
            <div className="space-y-2">
              <p className="font-medium">
                ğŸš€ æ‚¨çš„åˆ›ä½œæ½œåŠ›ä¸æ­¢äºæ­¤
              </p>
              <p className="text-sm text-muted-foreground">
                å‡çº§Proï¼Œäº«å—æ— é™åˆ›ä½œå’Œä¼˜å…ˆå¤„ç†
              </p>
              <div className="flex items-center gap-2">
                <Badge variant="success">é™æ—¶ä¼˜æƒ </Badge>
                <span className="text-sm line-through text-muted-foreground">
                  $29/æœˆ
                </span>
                <span className="text-sm font-bold text-primary">
                  $24/æœˆ
                </span>
              </div>
            </div>
            <Button
              size="icon"
              variant="ghost"
              onClick={() => setShow(false)}
            >
              <X className="w-4 h-4" />
            </Button>
          </div>
          <div className="mt-3 flex gap-2">
            <Button size="sm" className="flex-1">
              ç«‹å³å‡çº§
            </Button>
            <Button size="sm" variant="outline" onClick={() => setShow(false)}>
              ç¨åæé†’
            </Button>
          </div>
        </CardContent>
      </Card>
    </div>
  );
}

// ä½¿ç”¨ç»Ÿè®¡å±•ç¤º - æ¿€å‘ä»˜è´¹åŠ¨æœº
export function UsageMotivator() {
  const stats = useUserStats();
  
  return (
    <Card>
      <CardHeader>
        <CardTitle>æ‚¨çš„åˆ›ä½œæˆå°±</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="space-y-4">
          <div className="flex justify-between items-center">
            <span>æœ¬æœˆå·²åˆ›ä½œ</span>
            <span className="font-bold text-2xl">{stats.totalGenerated}</span>
          </div>
          
          {stats.approachingLimit && (
            <Alert>
              <AlertCircle className="w-4 h-4" />
              <AlertDescription>
                æ‚¨å³å°†è¾¾åˆ°å…è´¹ç‰ˆé™åˆ¶ã€‚å‡çº§Proç»§ç»­åˆ›ä½œï¼Œ
                <Link href="/pricing" className="font-medium underline">
                  æŸ¥çœ‹å‡çº§æ–¹æ¡ˆ
                </Link>
              </AlertDescription>
            </Alert>
          )}
          
          <div className="p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg">
            <p className="text-sm font-medium mb-2">
              Proç”¨æˆ·å¹³å‡æ¯æœˆåˆ›ä½œ
            </p>
            <p className="text-3xl font-bold text-primary">
              {stats.proAverage}+
            </p>
            <p className="text-xs text-muted-foreground mt-1">
              æ˜¯å…è´¹ç”¨æˆ·çš„10å€
            </p>
          </div>
        </div>
      </CardContent>
    </Card>
  );
}
```

### 9.5 å®æ–½æ•ˆæœè¿½è¸ª

```typescript
// è½¬åŒ–æ¼æ–—è¿½è¸ª
export const conversionEvents = {
  // æ¼æ–—å„é˜¶æ®µ
  VIEW_PRICING: 'view_pricing_page',
  SELECT_PLAN: 'select_plan',
  START_CHECKOUT: 'start_checkout',
  COMPLETE_PAYMENT: 'complete_payment',
  
  // è§¦å‘æ¥æº
  TRIGGER_SOURCES: {
    limit_reached: 'è¾¾åˆ°ä½¿ç”¨é™åˆ¶',
    feature_locked: 'åŠŸèƒ½é”å®š',
    upgrade_prompt: 'å‡çº§æç¤º',
    pricing_page: 'ä»·æ ¼é¡µé¢',
    trial_ending: 'è¯•ç”¨æœŸç»“æŸ'
  }
};

// è®°å½•è½¬åŒ–äº‹ä»¶
export function trackConversion(event: string, data: any) {
  analytics.track(event, {
    ...data,
    timestamp: new Date(),
    user_tier: getCurrentTier(),
    session_id: getSessionId()
  });
}
```

---

**å®æ–½ä¼˜å…ˆçº§ï¼šé«˜**  
**é¢„æœŸROIï¼š3-6ä¸ªæœˆå›æ”¶å¼€å‘æˆæœ¬**  
**é£é™©ï¼šéœ€è¦å¯†åˆ‡ç›‘æ§æœåŠ¡å™¨æˆæœ¬**

*æ–‡æ¡£ç‰ˆæœ¬ï¼š1.0*  
*æ›´æ–°æ—¥æœŸï¼š2025-08-15*