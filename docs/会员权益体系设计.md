# AI Universal Generator - 会员权益体系设计方案

## 一、会员等级体系设计

### 1.1 会员等级划分

| 等级 | 月费 | 年费(优惠) | 定位 |
|------|------|------------|------|
| **Free** | $0 | $0 | 体验用户 |
| **Basic** | $9 | $90 (17% off) | 个人用户 |
| **Pro** | $29 | $290 (17% off) | 专业创作者 |
| **Enterprise** | $99 | $990 (17% off) | 企业/团队 |

### 1.2 核心权益对比表

#### 🎯 AI 模型访问权限

| 功能 | Free | Basic | Pro | Enterprise |
|------|------|-------|-----|------------|
| **文本生成** |  |  |  |  |
| GPT-3.5 | ✅ 10次/天 | ✅ 100次/月 | ✅ 无限 | ✅ 无限 |
| GPT-4 | ❌ | ✅ 20次/月 | ✅ 200次/月 | ✅ 无限 |
| GPT-4o | ❌ | ❌ | ✅ 50次/月 | ✅ 无限 |
| Claude 3.5 | ❌ | ❌ | ✅ 100次/月 | ✅ 无限 |
| DeepSeek R1 | ❌ | ✅ 10次/月 | ✅ 100次/月 | ✅ 无限 |
| **图像生成** |  |  |  |  |
| DALL-E 2 | ❌ | ✅ 10张/月 | ✅ 50张/月 | ✅ 无限 |
| DALL-E 3 | ❌ | ❌ | ✅ 20张/月 | ✅ 无限 |
| Midjourney | ❌ | ❌ | ✅ 30张/月 | ✅ 无限 |
| FLUX | ❌ | ✅ 5张/月 | ✅ 50张/月 | ✅ 无限 |
| **视频生成** |  |  |  |  |
| 基础视频 | ❌ | ❌ | ✅ 5个/月 | ✅ 50个/月 |
| 高清视频 | ❌ | ❌ | ❌ | ✅ 20个/月 |

#### 💎 独特功能权益

| 功能 | Free | Basic | Pro | Enterprise |
|------|------|-------|-----|------------|
| **积分系统** |  |  |  |  |
| 注册赠送 | 10 | 100 | 500 | 2000 |
| 月度赠送 | 0 | 100 | 500 | 2000 |
| 积分有效期 | 7天 | 30天 | 90天 | 永久 |
| **生成速度** |  |  |  |  |
| 响应优先级 | 低 | 标准 | 高 | 最高 |
| 并发请求数 | 1 | 2 | 5 | 10 |
| 队列等待 | 可能 | 少量 | 优先 | 无需等待 |
| **高级功能** |  |  |  |  |
| API 访问 | ❌ | ❌ | ✅ 限速 | ✅ 无限 |
| 批量生成 | ❌ | ❌ | ✅ 10个 | ✅ 100个 |
| 自定义模板 | ❌ | 3个 | 20个 | 无限 |
| 历史记录 | 7天 | 30天 | 永久 | 永久 |
| 导出功能 | ❌ | ✅ | ✅ | ✅ |
| **协作功能** |  |  |  |  |
| 团队席位 | - | - | - | 5个 |
| 共享工作区 | ❌ | ❌ | ❌ | ✅ |
| 管理面板 | ❌ | ❌ | ❌ | ✅ |
| 使用统计 | ❌ | 基础 | 详细 | 完整分析 |
| **支持服务** |  |  |  |  |
| 社区支持 | ✅ | ✅ | ✅ | ✅ |
| Email支持 | ❌ | ✅ 48h | ✅ 24h | ✅ 2h |
| 优先支持 | ❌ | ❌ | ✅ | ✅ |
| 专属客服 | ❌ | ❌ | ❌ | ✅ |
| 定制培训 | ❌ | ❌ | ❌ | ✅ |
| **其他权益** |  |  |  |  |
| 去除水印 | ❌ | ✅ | ✅ | ✅ |
| 商用授权 | ❌ | ❌ | ✅ | ✅ |
| 白标功能 | ❌ | ❌ | ❌ | ✅ |
| SLA保证 | ❌ | ❌ | 99% | 99.9% |

## 二、技术实现方案

### 2.1 数据库改造

```sql
-- 1. 激活已有的 subscriptions 表
-- (表结构已存在于 src/db/subscriptions-schema.ts)

-- 2. 在 users 表添加订阅相关字段
ALTER TABLE users ADD COLUMN subscription_id INTEGER REFERENCES subscriptions(id);
ALTER TABLE users ADD COLUMN subscription_tier VARCHAR(20) DEFAULT 'free';
ALTER TABLE users ADD COLUMN subscription_expires_at TIMESTAMP;

-- 3. 创建功能权限映射表
CREATE TABLE feature_permissions (
  id SERIAL PRIMARY KEY,
  tier VARCHAR(20) NOT NULL, -- free, basic, pro, enterprise
  feature_key VARCHAR(100) NOT NULL, -- 功能标识
  allowed BOOLEAN DEFAULT true,
  daily_limit INTEGER, -- 每日限制
  monthly_limit INTEGER, -- 每月限制
  config JSONB, -- 其他配置
  UNIQUE(tier, feature_key)
);
```

### 2.2 权限检查中间件

```typescript
// src/middleware/subscription.ts
export async function checkSubscriptionAccess(
  userUuid: string,
  feature: string,
  model?: string
) {
  // 1. 获取用户订阅信息
  const subscription = await getUserSubscription(userUuid);
  
  // 2. 检查订阅是否有效
  if (!subscription || subscription.status !== 'active') {
    return { allowed: false, reason: 'No active subscription' };
  }
  
  // 3. 检查功能权限
  const permission = await getFeaturePermission(subscription.tier, feature);
  
  // 4. 检查使用限制
  if (permission.monthly_limit) {
    const usage = await getMonthlyUsage(userUuid, feature);
    if (usage >= permission.monthly_limit) {
      return { 
        allowed: false, 
        reason: `Monthly limit reached (${usage}/${permission.monthly_limit})` 
      };
    }
  }
  
  // 5. 检查模型访问权限
  if (model && !permission.allowed_models?.includes(model)) {
    return { 
      allowed: false, 
      reason: `Model ${model} not available in your plan` 
    };
  }
  
  return { allowed: true };
}
```

### 2.3 API 路由改造示例

```typescript
// src/app/api/demo/gen-text/route.ts
export async function POST(req: Request) {
  const session = await auth();
  
  // 1. 认证检查
  if (!session?.user?.email) {
    return respErr("Please login first");
  }
  
  // 2. 获取用户信息
  const user = await getUserWithSubscription(session.user.email);
  
  // 3. 订阅权限检查
  const accessCheck = await checkSubscriptionAccess(
    user.uuid,
    'text_generation',
    model
  );
  
  if (!accessCheck.allowed) {
    // 根据用户等级返回不同提示
    if (user.subscription_tier === 'free') {
      return respErr(
        "This feature requires a paid subscription. Upgrade to Basic plan for just $9/month!",
        { upgradeUrl: '/pricing' }
      );
    }
    return respErr(accessCheck.reason);
  }
  
  // 4. 执行生成...
  // 5. 记录使用情况
  await recordUsage(user.uuid, 'text_generation', model);
}
```

## 三、差异化功能实现

### 3.1 速度优先级队列

```typescript
// 根据用户等级分配不同优先级
const PRIORITY_LEVELS = {
  free: 1,
  basic: 5,
  pro: 10,
  enterprise: 20
};

// 使用 Redis 实现优先级队列
async function addToQueue(task: GenerationTask) {
  const priority = PRIORITY_LEVELS[task.userTier];
  await redis.zadd('generation_queue', priority, JSON.stringify(task));
}
```

### 3.2 并发限制

```typescript
// 不同等级的并发限制
const CONCURRENT_LIMITS = {
  free: 1,
  basic: 2,
  pro: 5,
  enterprise: 10
};

// 使用 Redis 实现并发控制
async function checkConcurrency(userUuid: string, tier: string) {
  const current = await redis.get(`concurrent:${userUuid}`);
  const limit = CONCURRENT_LIMITS[tier];
  
  if (current >= limit) {
    throw new Error(`Concurrent limit reached (${current}/${limit})`);
  }
  
  await redis.incr(`concurrent:${userUuid}`);
  // 设置过期时间防止死锁
  await redis.expire(`concurrent:${userUuid}`, 60);
}
```

### 3.3 功能开关

```typescript
// 基于订阅等级的功能开关
const FEATURE_FLAGS = {
  free: {
    watermark: true,
    export: false,
    api_access: false,
    batch_generation: false,
    custom_templates: false,
    advanced_models: false,
  },
  basic: {
    watermark: false,
    export: true,
    api_access: false,
    batch_generation: false,
    custom_templates: true,
    advanced_models: ['gpt-4', 'dall-e-2'],
  },
  pro: {
    watermark: false,
    export: true,
    api_access: true,
    batch_generation: true,
    custom_templates: true,
    advanced_models: ['gpt-4', 'gpt-4o', 'dall-e-3', 'claude-3.5'],
  },
  enterprise: {
    watermark: false,
    export: true,
    api_access: true,
    batch_generation: true,
    custom_templates: true,
    advanced_models: 'all',
    white_label: true,
    custom_domain: true,
  }
};
```

## 四、UI/UX 差异化

### 4.1 会员标识

```tsx
// 用户界面显示会员等级
<Badge variant={getUserBadgeVariant(user.subscription_tier)}>
  {user.subscription_tier === 'enterprise' && <Crown className="w-3 h-3 mr-1" />}
  {user.subscription_tier === 'pro' && <Star className="w-3 h-3 mr-1" />}
  {user.subscription_tier === 'basic' && <Zap className="w-3 h-3 mr-1" />}
  {user.subscription_tier.toUpperCase()}
</Badge>
```

### 4.2 功能锁定提示

```tsx
// 对未解锁功能显示升级提示
{!canUseFeature('advanced_models') && (
  <div className="relative">
    <div className="absolute inset-0 bg-black/60 flex items-center justify-center rounded-lg">
      <div className="text-center text-white p-4">
        <Lock className="w-8 h-8 mx-auto mb-2" />
        <p className="font-semibold">Pro Feature</p>
        <p className="text-sm">Upgrade to Pro to unlock</p>
        <Button size="sm" className="mt-2">
          Upgrade Now
        </Button>
      </div>
    </div>
    {/* 显示模糊的功能预览 */}
    <div className="filter blur-sm pointer-events-none">
      {/* 功能内容 */}
    </div>
  </div>
)}
```

### 4.3 使用量仪表板

```tsx
// 显示当前使用量和限制
<Card>
  <CardHeader>
    <CardTitle>Usage This Month</CardTitle>
  </CardHeader>
  <CardContent>
    <div className="space-y-4">
      {/* 文本生成使用量 */}
      <div>
        <div className="flex justify-between text-sm mb-1">
          <span>Text Generation</span>
          <span>{usage.text}/{limits.text || '∞'}</span>
        </div>
        <Progress value={(usage.text / limits.text) * 100} />
      </div>
      
      {/* 图像生成使用量 */}
      <div>
        <div className="flex justify-between text-sm mb-1">
          <span>Image Generation</span>
          <span>{usage.image}/{limits.image || '∞'}</span>
        </div>
        <Progress value={(usage.image / limits.image) * 100} />
      </div>
      
      {/* 视频生成使用量 */}
      {user.tier !== 'free' && user.tier !== 'basic' && (
        <div>
          <div className="flex justify-between text-sm mb-1">
            <span>Video Generation</span>
            <span>{usage.video}/{limits.video || '∞'}</span>
          </div>
          <Progress value={(usage.video / limits.video) * 100} />
        </div>
      )}
    </div>
  </CardContent>
</Card>
```

## 五、实施计划

### 第一阶段：基础架构（1周）
1. ✅ 激活 subscriptions 表
2. ✅ 实现订阅服务层
3. ✅ 添加权限检查中间件
4. ✅ 更新用户模型

### 第二阶段：功能差异化（2周）
1. ✅ 实现模型访问限制
2. ✅ 添加使用量追踪
3. ✅ 实现优先级队列
4. ✅ 添加并发控制

### 第三阶段：UI/UX 优化（1周）
1. ✅ 更新定价页面
2. ✅ 添加会员标识
3. ✅ 实现功能锁定提示
4. ✅ 创建使用量仪表板

### 第四阶段：高级功能（2周）
1. ✅ API 访问控制
2. ✅ 批量生成功能
3. ✅ 自定义模板系统
4. ✅ 团队协作功能

## 六、监控与优化

### 6.1 关键指标
- 转化率：免费→付费
- 升级率：Basic→Pro→Enterprise
- 留存率：各等级用户留存
- 使用率：功能使用频率
- 满意度：NPS 评分

### 6.2 A/B 测试
- 价格测试
- 功能组合测试
- 限制阈值测试
- UI 提示文案测试

## 七、竞品对比优势

| 功能 | 我们 | OpenAI Plus | Claude Pro | Midjourney |
|------|------|-------------|------------|------------|
| 月费 | $9-99 | $20 | $20 | $10-120 |
| 多模型支持 | ✅ 全部 | ❌ 仅OpenAI | ❌ 仅Claude | ❌ 仅图像 |
| API 访问 | ✅ Pro起 | ❌ | ❌ | ❌ |
| 团队协作 | ✅ Enterprise | ❌ | ❌ | ❌ |
| 白标定制 | ✅ Enterprise | ❌ | ❌ | ❌ |
| 中文优化 | ✅ | 部分 | 部分 | ❌ |

## 八、营销策略

### 8.1 免费试用
- 注册送 10 积分
- 14 天 Pro 试用
- 限时升级优惠

### 8.2 推荐奖励
- 推荐成功送积分
- 推荐付费用户得佣金
- 团队折扣

### 8.3 季节性促销
- 黑五优惠
- 新年特惠
- 学生折扣

## 九、商业化转化策略

### 9.1 减少购买链路

#### 策略目标
将用户从认知到付费的路径最小化，减少流失率。

#### 实施方案

```typescript
/**
 * 一键升级组件
 * 问题：减少用户决策成本和操作步骤
 * 解决方案：在关键触点嵌入快速升级入口
 */
export function QuickUpgradeButton({ feature, currentTier }) {
  return (
    <Button
      onClick={() => {
        // 直接跳转到支付，预选推荐方案
        router.push(`/checkout?plan=pro&period=yearly&ref=${feature}`);
      }}
      className="bg-gradient-to-r from-purple-600 to-pink-600"
    >
      <Zap className="w-4 h-4 mr-1" />
      立即解锁 • 仅需 $24/月
    </Button>
  );
}

// 在功能受限时触发
export function FeatureLimitModal({ limitType }) {
  const benefits = getUpgradeBenefits(limitType);
  
  return (
    <Modal>
      <div className="text-center p-6">
        <h3>您已达到免费版限制</h3>
        <p className="text-muted-foreground mt-2">
          升级到 Pro 版本，立即获得：
        </p>
        <ul className="mt-4 space-y-2">
          {benefits.map(benefit => (
            <li key={benefit} className="flex items-center">
              <Check className="w-4 h-4 text-green-500 mr-2" />
              {benefit}
            </li>
          ))}
        </ul>
        <div className="mt-6 space-y-3">
          <Button onClick={handleOneClickUpgrade} size="lg" className="w-full">
            一键升级 Pro（省17%年费）
          </Button>
          <Button variant="outline" onClick={continueFree}>
            继续免费版
          </Button>
        </div>
      </div>
    </Modal>
  );
}
```

#### 关键实施点
1. **嵌入式支付**：在产品内直接完成支付，无需跳转
2. **保存支付方式**：记住用户支付信息，实现一键续费
3. **智能触发时机**：在用户需求最强烈时展示升级选项
4. **简化选择**：默认推荐最优方案，减少选择困难

### 9.2 做好价格差异

#### 价格锚定策略

```typescript
// 价格展示组件 - 利用锚定效应
export function PricingDisplay() {
  return (
    <div className="grid grid-cols-3 gap-6">
      {/* Basic - 对比锚点 */}
      <Card>
        <CardHeader>
          <h3>Basic</h3>
          <div className="mt-4">
            <span className="text-3xl font-bold">$9</span>
            <span className="text-muted-foreground">/月</span>
          </div>
        </CardHeader>
      </Card>
      
      {/* Pro - 主推方案 */}
      <Card className="border-2 border-primary relative">
        <Badge className="absolute -top-3 left-1/2 -translate-x-1/2">
          最受欢迎
        </Badge>
        <CardHeader>
          <h3>Pro</h3>
          <div className="mt-4">
            <span className="text-3xl font-bold">$29</span>
            <span className="text-muted-foreground">/月</span>
            <p className="text-sm text-green-600 mt-2">
              相比 Basic 仅多 $20，功能提升 10 倍
            </p>
          </div>
        </CardHeader>
      </Card>
      
      {/* Enterprise - 价格天花板 */}
      <Card>
        <CardHeader>
          <h3>Enterprise</h3>
          <div className="mt-4">
            <span className="text-3xl font-bold">$99</span>
            <span className="text-muted-foreground">/月</span>
          </div>
        </CardHeader>
      </Card>
    </div>
  );
}

// 价值对比表 - 突出差异
export function ValueComparison() {
  const metrics = [
    { feature: "API 调用次数", basic: "100", pro: "2000", multiplier: "20x" },
    { feature: "模型选择", basic: "3个", pro: "15个", multiplier: "5x" },
    { feature: "生成速度", basic: "标准", pro: "优先", multiplier: "3x" },
    { feature: "存储空间", basic: "1GB", pro: "50GB", multiplier: "50x" },
  ];
  
  return (
    <Table>
      <TableHeader>
        <TableRow>
          <TableHead>功能对比</TableHead>
          <TableHead>Basic ($9)</TableHead>
          <TableHead>Pro ($29)</TableHead>
          <TableHead>价值提升</TableHead>
        </TableRow>
      </TableHeader>
      <TableBody>
        {metrics.map((item) => (
          <TableRow key={item.feature}>
            <TableCell>{item.feature}</TableCell>
            <TableCell>{item.basic}</TableCell>
            <TableCell className="font-semibold">{item.pro}</TableCell>
            <TableCell>
              <Badge variant="success">{item.multiplier}</Badge>
            </TableCell>
          </TableRow>
        ))}
      </TableBody>
    </Table>
  );
}
```

### 9.3 默认年费

#### 年费优先展示策略

```typescript
/**
 * 价格切换组件
 * 策略：默认展示年费，强调节省金额
 */
export function BillingToggle() {
  const [period, setPeriod] = useState('yearly'); // 默认年费
  
  const savings = {
    basic: { monthly: 9, yearly: 7.5, save: 18 },
    pro: { monthly: 29, yearly: 24, save: 60 },
    enterprise: { monthly: 99, yearly: 82.5, save: 198 }
  };
  
  return (
    <div className="flex flex-col items-center space-y-4">
      {/* 切换按钮 - 年费选项更突出 */}
      <div className="inline-flex items-center bg-muted p-1 rounded-lg">
        <button
          onClick={() => setPeriod('monthly')}
          className={cn(
            "px-4 py-2 rounded-md transition",
            period === 'monthly' 
              ? "bg-background shadow-sm" 
              : "text-muted-foreground"
          )}
        >
          月付
        </button>
        <button
          onClick={() => setPeriod('yearly')}
          className={cn(
            "px-4 py-2 rounded-md transition relative",
            period === 'yearly' 
              ? "bg-primary text-primary-foreground shadow-sm" 
              : "text-muted-foreground"
          )}
        >
          年付
          <Badge className="absolute -top-2 -right-2 text-xs">
            省17%
          </Badge>
        </button>
      </div>
      
      {/* 节省金额提示 */}
      {period === 'yearly' && (
        <p className="text-green-600 font-medium animate-in fade-in">
          🎉 选择年付，每年节省 ${savings.pro.save}
        </p>
      )}
    </div>
  );
}

// 结账页面 - 预选年费
export function CheckoutForm({ plan = 'pro' }) {
  const [billingPeriod, setBillingPeriod] = useState('yearly');
  
  const pricing = {
    monthly: { basic: 9, pro: 29, enterprise: 99 },
    yearly: { 
      basic: 90, // 显示总价
      pro: 290,
      enterprise: 990 
    }
  };
  
  return (
    <form>
      {/* 账单周期选择 - 年费有折扣标签 */}
      <RadioGroup value={billingPeriod} onValueChange={setBillingPeriod}>
        <div className="space-y-3">
          <label className="flex items-center justify-between p-4 border rounded-lg cursor-pointer hover:bg-accent">
            <div className="flex items-center">
              <RadioGroupItem value="monthly" />
              <div className="ml-3">
                <p className="font-medium">月付</p>
                <p className="text-sm text-muted-foreground">
                  ${pricing.monthly[plan]}/月
                </p>
              </div>
            </div>
          </label>
          
          <label className="flex items-center justify-between p-4 border-2 border-primary rounded-lg cursor-pointer bg-primary/5">
            <div className="flex items-center">
              <RadioGroupItem value="yearly" />
              <div className="ml-3">
                <p className="font-medium">
                  年付
                  <Badge className="ml-2" variant="success">推荐</Badge>
                </p>
                <p className="text-sm text-muted-foreground">
                  ${(pricing.yearly[plan] / 12).toFixed(2)}/月（总计 ${pricing.yearly[plan]}）
                </p>
              </div>
            </div>
            <div className="text-right">
              <p className="text-sm font-medium text-green-600">
                节省17%
              </p>
              <p className="text-xs text-muted-foreground">
                省${pricing.monthly[plan] * 12 - pricing.yearly[plan]}
              </p>
            </div>
          </label>
        </div>
      </RadioGroup>
    </form>
  );
}
```

### 9.4 有意识的提醒用户付费

#### 智能付费提醒系统

```typescript
/**
 * 付费提醒管理器
 * 策略：在合适的时机和场景提醒用户付费价值
 */
class PaymentReminderManager {
  // 提醒触发规则
  private triggers = {
    // 使用量触发
    usageLimit: {
      threshold: 0.8, // 使用量达到80%
      message: "您已使用80%的免费额度，升级享受无限使用",
      action: "查看Pro方案"
    },
    
    // 功能触发
    featureBlock: {
      message: "此功能仅限Pro用户，立即解锁全部高级功能",
      action: "升级到Pro"
    },
    
    // 时间触发
    trialEnding: {
      daysLeft: 3,
      message: "试用期还剩3天，现在升级享受限时优惠",
      action: "获取优惠"
    },
    
    // 成就触发
    milestone: {
      generates: 50,
      message: "恭喜！您已生成50个作品，升级Pro提升创作效率",
      action: "提升效率"
    }
  };
  
  // 展示付费价值
  showValueProposition(context: string) {
    const benefits = this.getContextualBenefits(context);
    
    return {
      title: "解锁更多可能",
      benefits,
      cta: this.getSmartCTA(context),
      urgency: this.createUrgency()
    };
  }
  
  // 上下文相关的利益点
  private getContextualBenefits(context: string) {
    const benefitMap = {
      'text_generation': [
        '无限制使用GPT-4和Claude',
        '优先处理，生成速度提升3倍',
        '解锁高级写作模板'
      ],
      'image_generation': [
        '每月500张高清图像',
        '独家访问DALL-E 3',
        '批量生成和编辑功能'
      ],
      'api_limit': [
        'API调用量提升20倍',
        '更高的并发请求数',
        '专属技术支持'
      ]
    };
    
    return benefitMap[context] || benefitMap['text_generation'];
  }
  
  // 智能CTA文案
  private getSmartCTA(context: string) {
    const hour = new Date().getHours();
    const isWeekend = [0, 6].includes(new Date().getDay());
    
    if (isWeekend) {
      return "周末特惠 • 立即升级";
    }
    
    if (hour >= 9 && hour <= 12) {
      return "早鸟优惠 • 立即开始";
    }
    
    if (hour >= 20) {
      return "限时优惠 • 今日截止";
    }
    
    return "立即升级 • 解锁全部功能";
  }
  
  // 创造紧迫感
  private createUrgency() {
    const strategies = [
      { type: 'discount', message: '限时7折优惠' },
      { type: 'bonus', message: '升级送1000积分' },
      { type: 'scarcity', message: '仅剩最后10个优惠名额' },
      { type: 'social', message: '已有5000+用户选择Pro' }
    ];
    
    return strategies[Math.floor(Math.random() * strategies.length)];
  }
}

// UI组件 - 浮动提醒栏
export function FloatingUpgradeBar() {
  const [show, setShow] = useState(false);
  const user = useUser();
  
  useEffect(() => {
    // 智能显示逻辑
    if (user.tier === 'free' && user.usageRate > 0.5) {
      setTimeout(() => setShow(true), 5000); // 5秒后显示
    }
  }, [user]);
  
  if (!show || user.tier !== 'free') return null;
  
  return (
    <div className="fixed bottom-4 right-4 max-w-sm animate-in slide-in-from-bottom">
      <Card className="border-primary/50 bg-gradient-to-r from-purple-50 to-pink-50">
        <CardContent className="p-4">
          <div className="flex items-start justify-between">
            <div className="space-y-2">
              <p className="font-medium">
                🚀 您的创作潜力不止于此
              </p>
              <p className="text-sm text-muted-foreground">
                升级Pro，享受无限创作和优先处理
              </p>
              <div className="flex items-center gap-2">
                <Badge variant="success">限时优惠</Badge>
                <span className="text-sm line-through text-muted-foreground">
                  $29/月
                </span>
                <span className="text-sm font-bold text-primary">
                  $24/月
                </span>
              </div>
            </div>
            <Button
              size="icon"
              variant="ghost"
              onClick={() => setShow(false)}
            >
              <X className="w-4 h-4" />
            </Button>
          </div>
          <div className="mt-3 flex gap-2">
            <Button size="sm" className="flex-1">
              立即升级
            </Button>
            <Button size="sm" variant="outline" onClick={() => setShow(false)}>
              稍后提醒
            </Button>
          </div>
        </CardContent>
      </Card>
    </div>
  );
}

// 使用统计展示 - 激发付费动机
export function UsageMotivator() {
  const stats = useUserStats();
  
  return (
    <Card>
      <CardHeader>
        <CardTitle>您的创作成就</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="space-y-4">
          <div className="flex justify-between items-center">
            <span>本月已创作</span>
            <span className="font-bold text-2xl">{stats.totalGenerated}</span>
          </div>
          
          {stats.approachingLimit && (
            <Alert>
              <AlertCircle className="w-4 h-4" />
              <AlertDescription>
                您即将达到免费版限制。升级Pro继续创作，
                <Link href="/pricing" className="font-medium underline">
                  查看升级方案
                </Link>
              </AlertDescription>
            </Alert>
          )}
          
          <div className="p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg">
            <p className="text-sm font-medium mb-2">
              Pro用户平均每月创作
            </p>
            <p className="text-3xl font-bold text-primary">
              {stats.proAverage}+
            </p>
            <p className="text-xs text-muted-foreground mt-1">
              是免费用户的10倍
            </p>
          </div>
        </div>
      </CardContent>
    </Card>
  );
}
```

### 9.5 实施效果追踪

```typescript
// 转化漏斗追踪
export const conversionEvents = {
  // 漏斗各阶段
  VIEW_PRICING: 'view_pricing_page',
  SELECT_PLAN: 'select_plan',
  START_CHECKOUT: 'start_checkout',
  COMPLETE_PAYMENT: 'complete_payment',
  
  // 触发来源
  TRIGGER_SOURCES: {
    limit_reached: '达到使用限制',
    feature_locked: '功能锁定',
    upgrade_prompt: '升级提示',
    pricing_page: '价格页面',
    trial_ending: '试用期结束'
  }
};

// 记录转化事件
export function trackConversion(event: string, data: any) {
  analytics.track(event, {
    ...data,
    timestamp: new Date(),
    user_tier: getCurrentTier(),
    session_id: getSessionId()
  });
}
```

---

**实施优先级：高**  
**预期ROI：3-6个月回收开发成本**  
**风险：需要密切监控服务器成本**

*文档版本：1.0*  
*更新日期：2025-08-15*