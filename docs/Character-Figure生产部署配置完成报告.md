# Character Figure AI Generator ç”Ÿäº§éƒ¨ç½²é…ç½®å®ŒæˆæŠ¥å‘Š

## é¡¹ç›®æ¦‚è§ˆ

æœ¬æŠ¥å‘Šæ€»ç»“äº† Character Figure AI Generator åœ¨ Vercel å¹³å°ä¸Šçš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²é…ç½®ã€‚æ‰€æœ‰å¿…éœ€çš„é…ç½®æ–‡ä»¶ã€ç›‘æ§ç³»ç»Ÿå’Œå®‰å…¨æªæ–½å·²å®Œæˆã€‚

## ğŸš€ å·²å®Œæˆçš„é…ç½®

### 1. Vercel éƒ¨ç½²é…ç½® (`vercel.json`)

#### æ ¸å¿ƒé…ç½®
- **å¤šåŒºåŸŸéƒ¨ç½²**: `iad1` (ç¾å›½ä¸œéƒ¨), `hnd1` (äºšæ´²), `fra1` (æ¬§æ´²)
- **Node.js ç‰ˆæœ¬**: 20.x
- **æ¡†æ¶**: Next.js 15.2.3
- **æ„å»ºä¼˜åŒ–**: ç‹¬ç«‹è¾“å‡ºæ¨¡å¼

#### å‡½æ•°é…ç½®
```json
{
  "src/app/api/character-figure/**/*": {
    "runtime": "nodejs20.x",
    "maxDuration": 300,
    "memory": 2048
  },
  "src/app/api/nano-banana/**/*": {
    "runtime": "nodejs20.x", 
    "maxDuration": 300,
    "memory": 2048
  }
}
```

#### å®‰å…¨å¤´éƒ¨é…ç½®
- **CSP**: å†…å®¹å®‰å…¨ç­–ç•¥é˜²æ­¢XSSæ”»å‡»
- **HSTS**: å¼ºåˆ¶HTTPSä¼ è¾“
- **å®‰å…¨å“åº”å¤´**: é˜²æ­¢ç‚¹å‡»åŠ«æŒå’Œå†…å®¹ç±»å‹æ··æ·†

#### æ€§èƒ½ä¼˜åŒ–
- **é™æ€èµ„æºç¼“å­˜**: 1å¹´ç¼“å­˜æœŸ
- **å›¾ç‰‡ä¼˜åŒ–ç¼“å­˜**: 1å°æ—¶ç¼“å­˜ï¼Œå»¶è¿Ÿé‡æ–°éªŒè¯
- **APIå“åº”**: ç¦ç”¨ç¼“å­˜ç¡®ä¿å®æ—¶æ€§

### 2. Next.js é…ç½®ä¼˜åŒ– (`next.config.mjs`)

#### Webpack ä¼˜åŒ–
- **ä»£ç åˆ†å‰²**: æœ€å¤§chunkå¤§å°244KB
- **Tree Shaking**: è‡ªåŠ¨åˆ é™¤æœªä½¿ç”¨ä»£ç 
- **Bundleåˆ†æ**: æ”¯æŒæ„å»ºåˆ†æ

#### å›¾ç‰‡ä¼˜åŒ–
- **ç°ä»£æ ¼å¼æ”¯æŒ**: AVIF, WebP
- **è¿œç¨‹åŸŸåç™½åå•**: 
  - `*.kie.ai` (Nano Banana API)
  - `*.cloudflare.com` (CDN)
  - `*.r2.cloudflarestorage.com` (å­˜å‚¨)
  - `replicate.delivery` (Replicate API)

#### æ€§èƒ½å¢å¼º
- **å­—ä½“ä¼˜åŒ–**: è‡ªåŠ¨å­—ä½“åŠ è½½ä¼˜åŒ–
- **æœåŠ¡ç«¯ç»„ä»¶**: å‡å°‘å®¢æˆ·ç«¯JavaScript
- **è¾¹ç¼˜è¿è¡Œæ—¶**: æ”¯æŒå…¨çƒåˆ†å¸ƒå¼éƒ¨ç½²

### 3. ä¸­é—´ä»¶é…ç½® (`middleware.ts`)

#### å›½é™…åŒ–è·¯ç”±
- **æ”¯æŒè¯­è¨€**: en, zh, ja, ko, ru, fr, de, ar, es, it
- **è‡ªåŠ¨è¯­è¨€æ£€æµ‹**: åŸºäºæµè§ˆå™¨åå¥½
- **è·¯å¾„é‡å†™**: æ™ºèƒ½URLå¤„ç†

#### ç”¨æˆ·å½’å› è·Ÿè¸ª
- **é¦–æ¬¡è®¿é—®è·Ÿè¸ª**: è®°å½•ç”¨æˆ·æ¥æº
- **ä¼šè¯ç®¡ç†**: 30å¤©cookieç”Ÿå‘½å‘¨æœŸ
- **è½¬åŒ–è·Ÿè¸ª**: UTMå‚æ•°è§£æ

### 4. ç›‘æ§å’Œå¥åº·æ£€æŸ¥

#### å¥åº·æ£€æŸ¥ç«¯ç‚¹ (`/api/health`)
```typescript
{
  status: 'healthy' | 'unhealthy' | 'degraded',
  checks: {
    database: 'ok' | 'error' | 'warning',
    storage: 'ok' | 'error' | 'warning', 
    ai_services: 'ok' | 'error' | 'warning',
    payment: 'ok' | 'error' | 'warning'
  },
  metrics: {
    memory_usage: number,
    response_time: number
  }
}
```

#### Cron ä»»åŠ¡é…ç½®
- **ä¼šè¯æ¸…ç†**: æ¯æ—¥å‡Œæ™¨2ç‚¹ (`/api/cleanup/sessions`)
- **åˆ†ææŠ¥å‘Š**: æ¯æ—¥å‡Œæ™¨1ç‚¹ (`/api/analytics/daily-report`)

### 5. ç”Ÿäº§å‡†å¤‡æ£€æŸ¥è„šæœ¬

#### è‡ªåŠ¨åŒ–æ£€æŸ¥ (`scripts/production-readiness-check.js`)
- **ç¯å¢ƒå˜é‡éªŒè¯**: æ£€æŸ¥æ‰€æœ‰å¿…éœ€å˜é‡
- **ä¾èµ–é¡¹å®¡è®¡**: å®‰å…¨æ¼æ´æ£€æŸ¥
- **ç±»å‹æ£€æŸ¥**: TypeScriptç¼–è¯‘éªŒè¯
- **æ„å»ºéªŒè¯**: å®Œæ•´æ„å»ºæµ‹è¯•
- **APIç«¯ç‚¹æ£€æŸ¥**: å…³é”®ç«¯ç‚¹å­˜åœ¨æ€§éªŒè¯
- **æ•°æ®åº“è¿æ¥**: è¿æ¥å’Œè¡¨ç»“æ„éªŒè¯
- **å¤–éƒ¨æœåŠ¡**: AIæœåŠ¡å¯ç”¨æ€§æ£€æŸ¥

#### æ–°å¢NPMè„šæœ¬
```bash
npm run production:check    # è¿è¡Œç”Ÿäº§å‡†å¤‡æ£€æŸ¥
npm run production:deploy   # æ£€æŸ¥é€šè¿‡åéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
```

## ğŸ”§ é…ç½®æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒé…ç½®æ–‡ä»¶
- âœ… `vercel.json` - Verceléƒ¨ç½²é…ç½®
- âœ… `next.config.mjs` - Next.jsä¼˜åŒ–é…ç½®
- âœ… `middleware.ts` - è·¯ç”±å’Œè¿½è¸ªä¸­é—´ä»¶
- âœ… `package.json` - æ–°å¢ç”Ÿäº§éƒ¨ç½²è„šæœ¬

### APIç«¯ç‚¹
- âœ… `/api/health` - å¥åº·æ£€æŸ¥
- âœ… `/api/cleanup/sessions` - å®šæ—¶æ¸…ç†ä»»åŠ¡
- âœ… `/api/analytics/daily-report` - æ—¥æŠ¥ç”Ÿæˆ
- âœ… `/api/character-figure/**` - è§’è‰²ç”ŸæˆAPI
- âœ… `/api/nano-banana/**` - Nano Bananaé›†æˆ

### æ–‡æ¡£
- âœ… `docs/Vercelç”Ÿäº§ç¯å¢ƒéƒ¨ç½²é…ç½®.md` - è¯¦ç»†éƒ¨ç½²æŒ‡å—
- âœ… `docs/Verceléƒ¨ç½²æ£€æŸ¥æ¸…å•.md` - å®Œæ•´æ£€æŸ¥æ¸…å•
- âœ… `docs/Character-Figureç”Ÿäº§éƒ¨ç½²é…ç½®å®ŒæˆæŠ¥å‘Š.md` - æœ¬æŠ¥å‘Š

## ğŸ“Š æ€§èƒ½ç›®æ ‡

### Core Web Vitals ç›®æ ‡
- **é¦–æ¬¡å†…å®¹ç»˜åˆ¶ (FCP)**: < 1.5s
- **æœ€å¤§å†…å®¹ç»˜åˆ¶ (LCP)**: < 2.5s
- **ç´¯ç§¯å¸ƒå±€åç§» (CLS)**: < 0.1
- **é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ (FID)**: < 100ms

### APIæ€§èƒ½ç›®æ ‡
- **æ ‡å‡†APIå“åº”**: < 2s
- **AIç”ŸæˆAPIå“åº”**: < 30s
- **å›¾ç‰‡åŠ è½½æ—¶é—´**: < 3s

### å¯ç”¨æ€§ç›®æ ‡
- **ç³»ç»Ÿæ­£å¸¸è¿è¡Œæ—¶é—´**: 99.9%
- **é”™è¯¯ç‡**: < 0.1%

## ğŸ” å®‰å…¨é…ç½®

### ç¯å¢ƒå˜é‡ä¿æŠ¤
- æ‰€æœ‰æ•æ„Ÿä¿¡æ¯ä½¿ç”¨ç¯å¢ƒå˜é‡
- ç”Ÿäº§ç¯å¢ƒå˜é‡åœ¨Vercel Dashboardä¸­é…ç½®
- å¼€å‘ç¯å¢ƒä½¿ç”¨`.env.local`

### APIå®‰å…¨
- è®¤è¯ä¿æŠ¤çš„ç«¯ç‚¹éœ€è¦ç™»å½•
- Rate limitingé˜²æ­¢æ»¥ç”¨
- CORSå¤´éƒ¨æ­£ç¡®é…ç½®
- è¾“å…¥éªŒè¯å’Œæ¸…ç†

### æ•°æ®å®‰å…¨
- æ•°æ®åº“è¿æ¥ä½¿ç”¨SSL
- APIå¯†é’¥ä¸æš´éœ²åœ¨å®¢æˆ·ç«¯
- ç”¨æˆ·æ•°æ®åŠ å¯†å­˜å‚¨

## ğŸš¨ å¿…éœ€çš„ç¯å¢ƒå˜é‡

### ç”Ÿäº§ç¯å¢ƒå¿…é¡»é…ç½®çš„å˜é‡

#### åŸºç¡€é…ç½®
```bash
NEXT_PUBLIC_WEB_URL="https://your-domain.com"
NODE_ENV="production"
NEXT_TELEMETRY_DISABLED="1"
```

#### æ•°æ®åº“
```bash
DATABASE_URL="postgresql://..."
```

#### è®¤è¯
```bash
AUTH_SECRET="your-secret-key"
AUTH_URL="https://your-domain.com/api/auth"
AUTH_GOOGLE_ID="..."
AUTH_GOOGLE_SECRET="..."
```

#### AIæœåŠ¡
```bash
NANO_BANANA_API_KEY="..."
NANO_BANANA_API_URL="https://api.kie.ai/nano-banana"
OPENAI_API_KEY="..."
```

#### å­˜å‚¨
```bash
STORAGE_ENDPOINT="..."
STORAGE_ACCESS_KEY="..."
STORAGE_SECRET_KEY="..."
STORAGE_BUCKET="..."
```

#### æ”¯ä»˜
```bash
STRIPE_PUBLIC_KEY="pk_live_..."
STRIPE_PRIVATE_KEY="sk_live_..."
STRIPE_WEBHOOK_SECRET="whsec_..."
```

## ğŸš€ éƒ¨ç½²æµç¨‹

### 1. é¢„éƒ¨ç½²æ£€æŸ¥
```bash
# è¿è¡Œç”Ÿäº§å‡†å¤‡æ£€æŸ¥
npm run production:check

# æ‰‹åŠ¨éªŒè¯æ„å»º
npm run build
npm run lint
npx tsc --noEmit
```

### 2. Vercelé¡¹ç›®è®¾ç½®
1. è¿æ¥GitHubä»“åº“
2. è®¾ç½®æ¡†æ¶ä¸ºNext.js
3. é…ç½®æ„å»ºè®¾ç½®
4. æ·»åŠ ç¯å¢ƒå˜é‡
5. é…ç½®è‡ªå®šä¹‰åŸŸå

### 3. éƒ¨ç½²æ‰§è¡Œ
```bash
# è‡ªåŠ¨æ£€æŸ¥å¹¶éƒ¨ç½²
npm run production:deploy

# æˆ–æ‰‹åŠ¨éƒ¨ç½²
vercel --prod
```

### 4. éƒ¨ç½²åéªŒè¯
- âœ… è®¿é—®ç”Ÿäº§URL
- âœ… æµ‹è¯•è®¤è¯æµç¨‹
- âœ… éªŒè¯AIç”ŸæˆåŠŸèƒ½
- âœ… æ£€æŸ¥æ”¯ä»˜æµç¨‹
- âœ… ç›‘æ§é”™è¯¯æ—¥å¿—

## ğŸ“ˆ ç›‘æ§å’Œç»´æŠ¤

### è‡ªåŠ¨ç›‘æ§
- **Vercel Analytics**: æ€§èƒ½å’Œç”¨æˆ·æŒ‡æ ‡
- **å¥åº·æ£€æŸ¥**: `/api/health` ç«¯ç‚¹
- **Cronä»»åŠ¡**: è‡ªåŠ¨åŒ–ç»´æŠ¤

### æ‰‹åŠ¨ç›‘æ§
- **Google PageSpeed Insights**: æ€§èƒ½æµ‹è¯•
- **é”™è¯¯æ—¥å¿—**: Vercel Dashboard
- **ç”¨æˆ·åé¦ˆ**: åº”ç”¨å†…åé¦ˆç³»ç»Ÿ

### å®šæœŸç»´æŠ¤
- **æ¯æ—¥**: æ£€æŸ¥é”™è¯¯æ—¥å¿—å’Œæ€§èƒ½æŒ‡æ ‡
- **æ¯å‘¨**: å®¡æŸ¥åˆ†ææ•°æ®å’Œç”¨æˆ·åé¦ˆ
- **æ¯æœˆ**: å®‰å…¨æ£€æŸ¥å’Œä¾èµ–æ›´æ–°
- **æ¯å­£åº¦**: æ€§èƒ½ä¼˜åŒ–å’Œæ¶æ„è¯„ä¼°

## âš ï¸ æ³¨æ„äº‹é¡¹

### éƒ¨ç½²å‰å¿…é¡»å®Œæˆ
1. æ‰€æœ‰ç¯å¢ƒå˜é‡æ­£ç¡®é…ç½®
2. æ•°æ®åº“schemaéƒ¨ç½²å®Œæˆ
3. DNSå’ŒSSLè¯ä¹¦é…ç½®
4. å¤–éƒ¨æœåŠ¡APIå¯†é’¥éªŒè¯

### å¸¸è§é—®é¢˜è§£å†³
1. **APIè¶…æ—¶**: æ£€æŸ¥å‡½æ•°å†…å­˜å’Œè¶…æ—¶é…ç½®
2. **å›¾ç‰‡åŠ è½½å¤±è´¥**: éªŒè¯åŸŸåç™½åå•
3. **è®¤è¯é—®é¢˜**: æ£€æŸ¥OAuthå›è°ƒURL
4. **æ•°æ®åº“è¿æ¥**: éªŒè¯è¿æ¥å­—ç¬¦ä¸²å’ŒSSLé…ç½®

### ç´§æ€¥å›æ»šè®¡åˆ’
- Vercel Dashboardä¸€é”®å›æ»š
- æ•°æ®åº“å¤‡ä»½æ¢å¤
- ç¯å¢ƒå˜é‡å›é€€
- ç›‘æ§ç³»ç»Ÿé‡ç½®

## ğŸ‰ éƒ¨ç½²å®Œæˆç¡®è®¤

### åŠŸèƒ½éªŒè¯æ¸…å•
- âœ… é¦–é¡µæ­£å¸¸åŠ è½½
- âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½•
- âœ… Character Figureç”Ÿæˆ
- âœ… æ”¯ä»˜æµç¨‹
- âœ… å¤šè¯­è¨€åˆ‡æ¢
- âœ… ç§»åŠ¨ç«¯é€‚é…

### æ€§èƒ½éªŒè¯
- âœ… åŠ è½½æ—¶é—´ç¬¦åˆç›®æ ‡
- âœ… Core Web Vitalsè¾¾æ ‡
- âœ… APIå“åº”æ—¶é—´æ­£å¸¸
- âœ… å›¾ç‰‡ä¼˜åŒ–ç”Ÿæ•ˆ

### å®‰å…¨éªŒè¯
- âœ… HTTPSå¼ºåˆ¶å¯ç”¨
- âœ… å®‰å…¨å¤´éƒ¨é…ç½®
- âœ… APIè®¤è¯ä¿æŠ¤
- âœ… æ•°æ®ä¼ è¾“åŠ å¯†

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è”ç³»æ–¹å¼
- **æŠ€æœ¯è´Ÿè´£äºº**: Claude Code Development Team
- **ç´§æ€¥è”ç³»**: é€šè¿‡GitHub Issues
- **æ–‡æ¡£æ›´æ–°**: å®šæœŸç»´æŠ¤é¡¹ç›®æ–‡æ¡£

### æ”¯æŒèµ„æº
- **Vercelæ–‡æ¡£**: https://vercel.com/docs
- **Next.jsæ–‡æ¡£**: https://nextjs.org/docs
- **é¡¹ç›®æ–‡æ¡£**: `/docs` ç›®å½•

---

## æ€»ç»“

Character Figure AI Generator å·²å®Œæˆç”Ÿäº§ç¯å¢ƒéƒ¨ç½²é…ç½®ï¼ŒåŒ…æ‹¬ï¼š

1. **å®Œæ•´çš„Vercelé…ç½®**ï¼šå¤šåŒºåŸŸéƒ¨ç½²ã€æ€§èƒ½ä¼˜åŒ–ã€å®‰å…¨å¤´éƒ¨
2. **ç›‘æ§ç³»ç»Ÿ**ï¼šå¥åº·æ£€æŸ¥ã€å®šæ—¶ä»»åŠ¡ã€åˆ†ææŠ¥å‘Š
3. **è‡ªåŠ¨åŒ–æ£€æŸ¥**ï¼šç”Ÿäº§å‡†å¤‡éªŒè¯è„šæœ¬
4. **è¯¦ç»†æ–‡æ¡£**ï¼šéƒ¨ç½²æŒ‡å—ã€æ£€æŸ¥æ¸…å•ã€æ•…éšœæ’é™¤

æ‰€æœ‰é…ç½®æ–‡ä»¶å·²å°±ä½ï¼Œç³»ç»Ÿå·²å‡†å¤‡å¥½è¿›è¡Œç”Ÿäº§éƒ¨ç½²ã€‚å»ºè®®åœ¨éƒ¨ç½²å‰è¿è¡Œ `npm run production:check` è¿›è¡Œæœ€ç»ˆéªŒè¯ã€‚

**éƒ¨ç½²æ—¥æœŸ**: 2025-08-28  
**é…ç½®ç‰ˆæœ¬**: v1.0  
**è´Ÿè´£å›¢é˜Ÿ**: Claude Code Development Team

ğŸš€ **å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼**